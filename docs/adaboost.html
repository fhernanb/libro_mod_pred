<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 AdaBoost | Modelos Predictivos</title>
  <meta name="description" content="Libro de Modelos Predictivos" />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="4 AdaBoost | Modelos Predictivos" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover.png" />
  <meta property="og:description" content="Libro de Modelos Predictivos" />
  <meta name="github-repo" content="fhernanb/libro_mod_pred" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 AdaBoost | Modelos Predictivos" />
  
  <meta name="twitter:description" content="Libro de Modelos Predictivos" />
  <meta name="twitter:image" content="images/cover.png" />

<meta name="author" content="Freddy Hernández" />


<meta name="date" content="2020-04-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="svm-clas.html"/>
<link rel="next" href="gradboost.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Modelos Predictivos</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenido</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#estructura-del-libro"><i class="fa fa-check"></i>Estructura del libro</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-y-convenciones"><i class="fa fa-check"></i>Software y convenciones</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#bloques-informativos"><i class="fa fa-check"></i>Bloques informativos</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="arb-de-regre.html"><a href="arb-de-regre.html"><i class="fa fa-check"></i><b>1</b> Árboles de regresión</a><ul>
<li class="chapter" data-level="" data-path="arb-de-regre.html"><a href="arb-de-regre.html#arboles"><i class="fa fa-check"></i>Árboles</a></li>
<li class="chapter" data-level="" data-path="arb-de-regre.html"><a href="arb-de-regre.html#arbol-de-decision"><i class="fa fa-check"></i>Árbol de decisión</a></li>
<li class="chapter" data-level="" data-path="arb-de-regre.html"><a href="arb-de-regre.html#tipos-de-arboles"><i class="fa fa-check"></i>Tipos de árboles</a></li>
<li class="chapter" data-level="" data-path="arb-de-regre.html"><a href="arb-de-regre.html#arbol-de-regresion"><i class="fa fa-check"></i>Árbol de regresión</a></li>
<li class="chapter" data-level="" data-path="arb-de-regre.html"><a href="arb-de-regre.html#paquetes-de-r-para-construir-arboles"><i class="fa fa-check"></i>Paquetes de R para construir árboles</a></li>
<li><a href="arb-de-regre.html#paquete-rpart">Paquete <strong>rpart</strong></a></li>
<li><a href="arb-de-regre.html#ejemplo-con-el-paquete-rpart">Ejemplo con el paquete <strong>rpart</strong></a></li>
<li><a href="arb-de-regre.html#ejemplo-con-el-paquete-tree">Ejemplo con el paquete <strong>tree</strong></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="arb-de-clasif.html"><a href="arb-de-clasif.html"><i class="fa fa-check"></i><b>2</b> Árboles de clasificación</a><ul>
<li class="chapter" data-level="" data-path="arb-de-clasif.html"><a href="arb-de-clasif.html#arboles-1"><i class="fa fa-check"></i>Árboles</a></li>
<li class="chapter" data-level="" data-path="arb-de-clasif.html"><a href="arb-de-clasif.html#arbol-de-decision-1"><i class="fa fa-check"></i>Árbol de decisión</a></li>
<li class="chapter" data-level="" data-path="arb-de-clasif.html"><a href="arb-de-clasif.html#tipos-de-arboles-1"><i class="fa fa-check"></i>Tipos de árboles</a></li>
<li class="chapter" data-level="" data-path="arb-de-clasif.html"><a href="arb-de-clasif.html#arbol-de-clasificacion"><i class="fa fa-check"></i>Árbol de clasificación</a></li>
<li class="chapter" data-level="" data-path="arb-de-clasif.html"><a href="arb-de-clasif.html#paquetes-de-r-para-construir-arboles-1"><i class="fa fa-check"></i>Paquetes de R para construir árboles</a></li>
<li><a href="arb-de-clasif.html#ejemplo-con-rpart">Ejemplo con <strong>rpart</strong></a></li>
<li><a href="arb-de-clasif.html#ejemplo-con-tree">Ejemplo con <strong>tree</strong></a></li>
<li class="chapter" data-level="" data-path="arb-de-clasif.html"><a href="arb-de-clasif.html#ejemplo"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="svm-clas.html"><a href="svm-clas.html"><i class="fa fa-check"></i><b>3</b> Support Vector Machines</a></li>
<li class="chapter" data-level="4" data-path="adaboost.html"><a href="adaboost.html"><i class="fa fa-check"></i><b>4</b> AdaBoost</a><ul>
<li class="chapter" data-level="" data-path="adaboost.html"><a href="adaboost.html#explicacion-sencilla-de-adaboost"><i class="fa fa-check"></i>Explicación sencilla de AdaBoost</a></li>
<li class="chapter" data-level="" data-path="adaboost.html"><a href="adaboost.html#explicacion-detallada-de-adaboost"><i class="fa fa-check"></i>Explicación detallada de AdaBoost</a></li>
<li class="chapter" data-level="" data-path="adaboost.html"><a href="adaboost.html#ejemplo-1"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="adaboost.html"><a href="adaboost.html#ejemplo-2"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="adaboost.html"><a href="adaboost.html#ejemplo-3"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="adaboost.html"><a href="adaboost.html#ejemplo-4"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="gradboost.html"><a href="gradboost.html"><i class="fa fa-check"></i><b>5</b> Gradient Boost</a><ul>
<li class="chapter" data-level="" data-path="gradboost.html"><a href="gradboost.html#ejemplo-5"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="gradboost.html"><a href="gradboost.html#ejemplo-6"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="gradboost.html"><a href="gradboost.html#ejemplo-7"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="reg-versus-arb.html"><a href="reg-versus-arb.html"><i class="fa fa-check"></i><b>6</b> Regresión lineal versus árboles de regresión</a><ul>
<li class="chapter" data-level="" data-path="reg-versus-arb.html"><a href="reg-versus-arb.html#regresion-lineal"><i class="fa fa-check"></i>Regresión lineal</a></li>
<li class="chapter" data-level="" data-path="reg-versus-arb.html"><a href="reg-versus-arb.html#arboles-de-regresion"><i class="fa fa-check"></i>Arboles de regresión</a></li>
<li class="chapter" data-level="" data-path="reg-versus-arb.html"><a href="reg-versus-arb.html#ejemplo-8"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="reg-versus-arb.html"><a href="reg-versus-arb.html#estudio-de-simulacion-para-comparar-ambos-metodos"><i class="fa fa-check"></i>Estudio de simulación para comparar ambos métodos</a></li>
<li class="chapter" data-level="" data-path="reg-versus-arb.html"><a href="reg-versus-arb.html#retos"><i class="fa fa-check"></i>Retos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modelos Predictivos</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="adaboost" class="section level1">
<h1><span class="header-section-number">4</span> AdaBoost</h1>
<p>AdaBoost (adaptive boosting) fue propuesto por <span class="citation">(Freund and Schapire <a href="#ref-freund_1995" role="doc-biblioref">1995</a>)</span> y consiste en crear varios predictores sencillos en secuencia, de tal manera que el segundo ajuste bien lo que el primero no ajustó, que el tercero ajuste un poco mejor lo que el segundo no pudo ajustar y así sucesivamente. En la siguiente figura se muestra una ilustración de lo que es AdaBoost.</p>
<p align="center">
<img src="images/adaboost_illustration.png" width="700">
</p>
<div id="explicacion-sencilla-de-adaboost" class="section level2 unnumbered">
<h2>Explicación sencilla de AdaBoost</h2>
<ol style="list-style-type: decimal">
<li>Entrene un clasificador.</li>
<li>Use el clasificador.</li>
<li>Identifique los casos que fueron mal clasificados.</li>
<li>Construya un nuevo clasificador que clasifique mejor los casos mal clasificados del punto anterior.</li>
<li>Repita los pasos 2 a 4 varias veces.</li>
<li>Asígnele un peso a cada clasificador y júntelos para obtener un clasificador con mejor desempeño.</li>
</ol>
</div>
<div id="explicacion-detallada-de-adaboost" class="section level2 unnumbered">
<h2>Explicación detallada de AdaBoost</h2>
<ol style="list-style-type: decimal">
<li>Inicie con un conjunto de entrenamiento <span class="math inline">\((X, Y)\)</span> con <span class="math inline">\(m\)</span> observaciones denotadas como <span class="math inline">\((x_1, y_1), \ldots, (x_m, y_m)\)</span> de tal manera que <span class="math inline">\(x_i \in R^p\)</span>. Los valores de <span class="math inline">\(y\)</span> deben ser -1 o 1 para aplicar el método.</li>
<li>Inicie con la distribución discreta <span class="math inline">\(D_1(i)=1/m\)</span> que indica el peso de la observación <span class="math inline">\(i\)</span> en la iteración <span class="math inline">\(1\)</span>.</li>
<li>Para <span class="math inline">\(t=1, \ldots, T\)</span>.</li>
</ol>
<ul>
<li>Construya un clasificador <span class="math inline">\(h_t\)</span> definido así: <span class="math inline">\(h_t : X \rightarrow \{-1, 1 \}\)</span>.</li>
<li>Calcule el error asociado <span class="math inline">\(\epsilon_t\)</span> al clasificador <span class="math inline">\(\epsilon_t= \sum_{i=1}^m D_t(i) \times \delta_i\)</span>, donde <span class="math inline">\(\delta_i=0\)</span> si <span class="math inline">\(h_t(x_i)=y_i\)</span>, es decir, si fue correcta la clasificación; caso contrario es <span class="math inline">\(\delta_i=1\)</span>.</li>
<li>Calcule la nueva distribución <span class="math inline">\(D_{t+1}(i)=D_{t}(i) \times F_i / Z_t\)</span>, donde:
<ul>
<li><span class="math inline">\(F_i=\exp(-\alpha_t)\)</span> si la clasificación fue correcta, es decir si <span class="math inline">\(h_t(x_i) = y_i\)</span>.</li>
<li><span class="math inline">\(F_i=\exp(\alpha_t)\)</span> si la clasificación fue incorrecta, es decir si <span class="math inline">\(h_t(x_i) \neq y_i\)</span>.</li>
<li><span class="math inline">\(\alpha_t=\frac{1}{2} \log \left( \frac{1-\epsilon_t}{\epsilon_t} \right)\)</span>.</li>
<li><span class="math inline">\(Z_t\)</span> es una constante de normalización de tal manera que <span class="math inline">\(\sum_{i=1}^m D_t(i)=1\)</span>. Usualmente es <span class="math inline">\(\sum D_{t}(i) \times F_i\)</span>.</li>
</ul></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Construya el clasificador final <span class="math inline">\(H_{final}\)</span> como el promedio ponderado de los <span class="math inline">\(t\)</span> clasificadores <span class="math inline">\(h_t\)</span>, usando <span class="math inline">\(H_{final}=sign(\sum_t \alpha_t h_t(x))\)</span>.</li>
</ol>
</div>
<div id="ejemplo-1" class="section level2 unnumbered">
<h2>Ejemplo</h2>
<p>Abajo se presenta un video con una explicación detallada de lo que es AdaBoost.</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/LsK-xG1cLYA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</div>
<div id="ejemplo-2" class="section level2 unnumbered">
<h2>Ejemplo</h2>
<p>En este ejemplo se ilustra la forma de aplicar AdaBoost a un conjunto de datos bivariados para clasificar en dos clases: -1 y +1.</p>
<div class="figure" style="text-align: center"><span id="fig:adaboost01"></span>
<img src="images/adaboost01.png" alt="Datos originales." width="220" />
<p class="caption">
Figure 4.1: Datos originales.
</p>
</div>
<p>En la siguiente figura se muestran 3 clasificadores (<span class="math inline">\(h_1\)</span>, <span class="math inline">\(h_2\)</span> y <span class="math inline">\(h_3\)</span>) sencillos o árboles de profundidad uno (tocones), que fueron creados de forma secuencial. Al observar <span class="math inline">\(h1\)</span>, se nota que él clasificó mal los + encerrados en círculos. Por esa razón, en la siguiente iteración esas observaciones mal clasificadas tuvieron un mayor peso o importancia en el nuevo clasificador <span class="math inline">\(h_2\)</span>, por eso es que esos símbolos + aparecen más grandes en la segunda figura. Al mirar el clasificador <span class="math inline">\(h_2\)</span> se observa que logró clasificar bien esos + grandes, sin embargo, él clasificó mal los - que están encerrados en círculos. Por esa razón, en la siguiente iteración esas observaciones mal clasificadas tuvieron un mayor peso o importancia en el nuevo clasificador <span class="math inline">\(h_3\)</span>, por eso es que esos símbolos - aparecen más grandes en la tercera figura. El clasificador <span class="math inline">\(h_3\)</span> logra clasificar mejor esos -.</p>
<div class="figure" style="text-align: center"><span id="fig:adaboost02"></span>
<img src="images/adaboost02.png" alt="Clasificadores." width="1216" />
<p class="caption">
Figure 4.2: Clasificadores.
</p>
</div>
<p>El clasificador final (<span class="math inline">\(h_{final}\)</span>) se construye como una ponderación de los clasificadores sencillos (<span class="math inline">\(h_1\)</span>, <span class="math inline">\(h_2\)</span> y <span class="math inline">\(h_3\)</span>) como se muestra a continuación.</p>
<div class="figure" style="text-align: center"><span id="fig:adaboost03"></span>
<img src="images/adaboost03.png" alt="Obtención clasificador final." width="1850" />
<p class="caption">
Figure 4.3: Obtención clasificador final.
</p>
</div>
<p>Los valores de <span class="math inline">\(\alpha_t\)</span> son las ponderaciones que aparecen en la explicación detallada del método.</p>
</div>
<div id="ejemplo-3" class="section level2 unnumbered">
<h2>Ejemplo</h2>
<p>En este ejemplo vamos a usar la base de datos <code>kyphosis</code> del paquete <strong>rpart</strong> <span class="citation">(Therneau and Atkinson <a href="#ref-R-rpart" role="doc-biblioref">2019</a>)</span>. A continuación las primeras líneas de la base de datos.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="kw">library</span>(rpart)</a>
<a class="sourceLine" id="cb60-2" title="2"><span class="kw">head</span>(kyphosis)</a></code></pre></div>
<pre><code>##   Kyphosis Age Number Start
## 1   absent  71      3     5
## 2   absent 158      3    14
## 3  present 128      4     5
## 4   absent   2      5     1
## 5   absent   1      4    15
## 6   absent   1      2    16</code></pre>
<p>El objetivo es crear un clasificador que use la información de Age, Number y Start para predecir el tipo de deformación kyphosis (absent or present). Como vamos a aplicar el AdaBoost manual debemos crear la variable respuesta en -1 y 1 así:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1">kyphosis<span class="op">$</span>y &lt;-<span class="st"> </span><span class="kw">ifelse</span>(kyphosis<span class="op">$</span>Kyphosis <span class="op">==</span><span class="st"> &#39;absent&#39;</span>, <span class="dv">-1</span>, <span class="dv">1</span>)</a></code></pre></div>
<p>Vamos a crear primero un modelo de referencia <code>mod0</code> que será un árbol tradicional.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1">mod0 &lt;-<span class="st"> </span><span class="kw">rpart</span>(y <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Number <span class="op">+</span><span class="st"> </span>Start, <span class="dt">data=</span>kyphosis, <span class="dt">method=</span><span class="st">&#39;class&#39;</span>)</a>
<a class="sourceLine" id="cb63-2" title="2">y0 &lt;-<span class="st"> </span><span class="kw">predict</span>(mod0, <span class="dt">type=</span><span class="st">&#39;class&#39;</span>)</a>
<a class="sourceLine" id="cb63-3" title="3">tabla0 &lt;-<span class="st"> </span><span class="kw">table</span>(y0, kyphosis<span class="op">$</span>y)</a>
<a class="sourceLine" id="cb63-4" title="4"><span class="kw">sum</span>(<span class="kw">diag</span>(tabla0)) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(tabla0)</a></code></pre></div>
<pre><code>## [1] 0.8395062</code></pre>
<p>En el siguiente código se usarán 20 iteraciones del AdaBoost en forma manual para crear 20 tocones (stumps) que unidos nos permitirán clasificar.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1">T &lt;-<span class="st"> </span><span class="dv">20</span> <span class="co"># numero de iteraciones</span></a>
<a class="sourceLine" id="cb65-2" title="2">m &lt;-<span class="st"> </span><span class="kw">nrow</span>(kyphosis)</a>
<a class="sourceLine" id="cb65-3" title="3">Dt &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">/</span>m, m) <span class="co"># D1</span></a>
<a class="sourceLine" id="cb65-4" title="4">alphas &lt;-<span class="st"> </span><span class="kw">numeric</span>(T) <span class="co"># Para almacenar alpha</span></a>
<a class="sourceLine" id="cb65-5" title="5">y_hats &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dt">ncol=</span>T, <span class="dt">nrow=</span>m) <span class="co"># Para almacenar la predicciones</span></a>
<a class="sourceLine" id="cb65-6" title="6"></a>
<a class="sourceLine" id="cb65-7" title="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>T) {</a>
<a class="sourceLine" id="cb65-8" title="8">  mod &lt;-<span class="st"> </span><span class="kw">rpart</span>(y <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Number <span class="op">+</span><span class="st"> </span>Start, <span class="dt">weights=</span>Dt, <span class="dt">data=</span>kyphosis, </a>
<a class="sourceLine" id="cb65-9" title="9">               <span class="dt">method=</span><span class="st">&#39;class&#39;</span>, <span class="dt">control=</span><span class="kw">rpart.control</span>(<span class="dt">maxdepth =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb65-10" title="10">  y_hat &lt;-<span class="st"> </span><span class="kw">predict</span>(mod, <span class="dt">type=</span><span class="st">&#39;class&#39;</span>)</a>
<a class="sourceLine" id="cb65-11" title="11">  error &lt;-<span class="st"> </span><span class="kw">ifelse</span>(y_hat <span class="op">==</span><span class="st"> </span>kyphosis<span class="op">$</span>y, <span class="dv">0</span>, <span class="dv">1</span>) <span class="co"># 1=error, 0=ok</span></a>
<a class="sourceLine" id="cb65-12" title="12">  epsilon_t &lt;-<span class="st"> </span><span class="kw">sum</span>(error <span class="op">*</span><span class="st"> </span>Dt)</a>
<a class="sourceLine" id="cb65-13" title="13">  alpha_t &lt;-<span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span><span class="kw">log</span>((<span class="dv">1</span><span class="op">-</span>epsilon_t)<span class="op">/</span>epsilon_t)</a>
<a class="sourceLine" id="cb65-14" title="14">  Fi &lt;-<span class="st"> </span><span class="kw">ifelse</span>(y_hat <span class="op">==</span><span class="st"> </span>kyphosis<span class="op">$</span>y, <span class="kw">exp</span>(<span class="op">-</span>alpha_t), <span class="kw">exp</span>(alpha_t))</a>
<a class="sourceLine" id="cb65-15" title="15">  Dt &lt;-<span class="st"> </span>Dt <span class="op">*</span><span class="st"> </span>Fi</a>
<a class="sourceLine" id="cb65-16" title="16">  Dt &lt;-<span class="st"> </span>Dt <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(Dt)</a>
<a class="sourceLine" id="cb65-17" title="17">  alphas[i] &lt;-<span class="st"> </span>alpha_t</a>
<a class="sourceLine" id="cb65-18" title="18">  y_hats[, i] &lt;-<span class="st"> </span><span class="kw">ifelse</span>(y_hat <span class="op">==</span><span class="st"> &#39;-1&#39;</span>, <span class="dv">-1</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb65-19" title="19">}</a></code></pre></div>
<p>Para obtener las estimaciones con los 20 tocones se usa el siguiente código.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1">y_final &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sign</span>(y_hats <span class="op">%*%</span><span class="st"> </span><span class="kw">matrix</span>(alphas, <span class="dt">ncol=</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb66-2" title="2">tabla_final &lt;-<span class="st"> </span><span class="kw">table</span>(y_final, kyphosis<span class="op">$</span>y)</a>
<a class="sourceLine" id="cb66-3" title="3"><span class="kw">sum</span>(<span class="kw">diag</span>(tabla_final)) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(tabla_final)</a></code></pre></div>
<pre><code>## [1] 0.8888889</code></pre>
<p>Por último vamos a usar la función <code>boosting</code> del paquete <strong>adabag</strong> <span class="citation">(Alfaro et al. <a href="#ref-R-adabag" role="doc-biblioref">2018</a>)</span> para aplicar AdaBoost de forma automática.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1"><span class="kw">library</span>(adabag)</a>
<a class="sourceLine" id="cb68-2" title="2">adaboost &lt;-<span class="st"> </span><span class="kw">bagging</span>(Kyphosis <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Number <span class="op">+</span><span class="st"> </span>Start,</a>
<a class="sourceLine" id="cb68-3" title="3">                    <span class="dt">coeflearn=</span><span class="st">&#39;Freund&#39;</span>,</a>
<a class="sourceLine" id="cb68-4" title="4">                    <span class="dt">data=</span>kyphosis, <span class="dt">mfinal=</span><span class="dv">20</span>)</a>
<a class="sourceLine" id="cb68-5" title="5">yhat_adaboost &lt;-<span class="st"> </span><span class="kw">predict</span>(adaboost, <span class="dt">newdata=</span>kyphosis)<span class="op">$</span>class</a>
<a class="sourceLine" id="cb68-6" title="6">tabla_adaboost &lt;-<span class="st"> </span><span class="kw">table</span>(yhat_adaboost, kyphosis<span class="op">$</span>Kyphosis)</a>
<a class="sourceLine" id="cb68-7" title="7"><span class="kw">sum</span>(<span class="kw">diag</span>(tabla_adaboost)) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(tabla_adaboost)</a></code></pre></div>
<pre><code>## [1] 0.8888889</code></pre>
<p>Abajo se muestra nuevamente el código para calcular las tres tasas de clasificación correcta para el modelo de referencia, el AdaBoost manual y el AdaBoost automático.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="kw">sum</span>(<span class="kw">diag</span>(tabla0)) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(tabla0)</a></code></pre></div>
<pre><code>## [1] 0.8395062</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1"><span class="kw">sum</span>(<span class="kw">diag</span>(tabla_final)) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(tabla_final)</a></code></pre></div>
<pre><code>## [1] 0.8888889</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="kw">sum</span>(<span class="kw">diag</span>(tabla_adaboost)) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(tabla_adaboost)</a></code></pre></div>
<pre><code>## [1] 0.8888889</code></pre>
<p>De la salida anterior se observa que el árbol tradicional tiene tasa de clasificación correcta menor que las dos versiones de AdaBoost.</p>
</div>
<div id="ejemplo-4" class="section level2 unnumbered">
<h2>Ejemplo</h2>
<p>En este ejemplo vamos a mostrar como usar el paquete <strong>adabag</strong> <span class="citation">(Alfaro et al. <a href="#ref-R-adabag" role="doc-biblioref">2018</a>)</span> para aplicar AdaBoost.</p>
<p>Como ejemplo vamos a usar la base de datos <code>iris</code> en la cual se tienen 4 variables que ayudarán a clasificar nuevas flores en una de tres especies. En la figura de abajo se muestran las tres especies y las cuatro variables.</p>
<div class="figure" style="text-align: center"><span id="fig:iris"></span>
<img src="images/iris.png" alt="Tipos de especies y variables en la base de datos iris." width="437" />
<p class="caption">
Figure 4.4: Tipos de especies y variables en la base de datos iris.
</p>
</div>
<p>Primero vamos a crear un árbol de clasificación usando el paquete <strong>rpart</strong> <span class="citation">(Therneau and Atkinson <a href="#ref-R-rpart" role="doc-biblioref">2019</a>)</span>, este modelo servirá como modelo de referencia. Para ajustar este modelo sólo vamos a usar las variables Sepal.Length y Sepal.Width
.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1"><span class="kw">library</span>(rpart)</a>
<a class="sourceLine" id="cb76-2" title="2">mod1 &lt;-<span class="st"> </span><span class="kw">rpart</span>(Species <span class="op">~</span><span class="st"> </span>Sepal.Length <span class="op">+</span><span class="st"> </span>Sepal.Width, <span class="dt">data=</span>iris)</a>
<a class="sourceLine" id="cb76-3" title="3">yhat1 &lt;-<span class="st"> </span><span class="kw">predict</span>(mod1, <span class="dt">type=</span><span class="st">&#39;class&#39;</span>)</a></code></pre></div>
<p>Ahora vamos a aplicar AdaBoost.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1"><span class="kw">library</span>(adabag)</a>
<a class="sourceLine" id="cb77-2" title="2">mod2 &lt;-<span class="st"> </span><span class="kw">bagging</span>(Species <span class="op">~</span><span class="st"> </span>Sepal.Length <span class="op">+</span><span class="st"> </span>Sepal.Width, </a>
<a class="sourceLine" id="cb77-3" title="3">                <span class="dt">data=</span>iris, <span class="dt">mfinal=</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb77-4" title="4">yhat2 &lt;-<span class="st"> </span><span class="kw">predict</span>(mod2, <span class="dt">newdata=</span>iris)<span class="op">$</span>class</a></code></pre></div>
<p>En los objetos <code>yhat1</code> y <code>yhat2</code> están las predicciones y con ellas vamos a formar las tablas de confusión para cada modelo.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1">t1 &lt;-<span class="st"> </span><span class="kw">table</span>(<span class="dt">real=</span>iris<span class="op">$</span>Species, <span class="dt">prediccion=</span>yhat1)</a>
<a class="sourceLine" id="cb78-2" title="2">t1</a></code></pre></div>
<pre><code>##             prediccion
## real         setosa versicolor virginica
##   setosa         49          1         0
##   versicolor      3         31        16
##   virginica       0         11        39</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1">t2 &lt;-<span class="st"> </span><span class="kw">table</span>(<span class="dt">real=</span>iris<span class="op">$</span>Species, <span class="dt">prediccion=</span>yhat2)</a>
<a class="sourceLine" id="cb80-2" title="2">t2</a></code></pre></div>
<pre><code>##             prediccion
## real         setosa versicolor virginica
##   setosa         46          4         0
##   versicolor      2         35        13
##   virginica       0         13        37</code></pre>
<p>Ahora vamos a calcular la tasa de clasificación correcta para cada una de las tablas anteriores.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="kw">sum</span>(<span class="kw">diag</span>(t1)) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(t1)</a></code></pre></div>
<pre><code>## [1] 0.7933333</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="kw">sum</span>(<span class="kw">diag</span>(t2)) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(t2)</a></code></pre></div>
<pre><code>## [1] 0.7866667</code></pre>
<p>De la anterior salida se observa que la tasa de clasificación correcta con un árbol tradicional es 79.3333333% mientras que con AdaBoost es 78.6666667%.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-R-adabag">
<p>Alfaro, Esteban; Gamez, Matias, Garcia, and Noelia; with contributions from Li Guo. 2018. <em>Adabag: Applies Multiclass Adaboost.m1, Samme and Bagging</em>. <a href="https://CRAN.R-project.org/package=adabag">https://CRAN.R-project.org/package=adabag</a>.</p>
</div>
<div id="ref-freund_1995">
<p>Freund, Yoav, and Robert E. Schapire. 1995. <em>A Desicion-Theoretic Generalization of on-Line Learning and an Application to Boosting</em>. Vol. 904. Springer, Berlin, Heidelberg.</p>
</div>
<div id="ref-R-rpart">
<p>Therneau, Terry, and Beth Atkinson. 2019. <em>Rpart: Recursive Partitioning and Regression Trees</em>. <a href="https://CRAN.R-project.org/package=rpart">https://CRAN.R-project.org/package=rpart</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="svm-clas.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="gradboost.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/fhernanb/libro_mod_pred/edit/master/81-AdaBoost.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
