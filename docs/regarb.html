<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>2 Regresión lineal versus árboles de regresión | Modelos Predictivos</title>
  <meta name="description" content="Libro de Modelos Predictivos fue .">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="2 Regresión lineal versus árboles de regresión | Modelos Predictivos" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover.png" />
  <meta property="og:description" content="Libro de Modelos Predictivos fue ." />
  <meta name="github-repo" content="fhernanb/libro_mod_pred" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Regresión lineal versus árboles de regresión | Modelos Predictivos" />
  
  <meta name="twitter:description" content="Libro de Modelos Predictivos fue ." />
  <meta name="twitter:image" content="images/cover.png" />

<meta name="author" content="Freddy Hernández">
<meta name="author" content="Olga Usuga">
<meta name="author" content="Carmen Patiño">


<meta name="date" content="2019-08-05">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="arboles-de-regresion.html">
<link rel="next" href="discri.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Modelos Predictivos</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenido</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#estructura-del-libro"><i class="fa fa-check"></i>Estructura del libro</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-y-convenciones"><i class="fa fa-check"></i>Software y convenciones</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#bloques-informativos"><i class="fa fa-check"></i>Bloques informativos</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="arboles-de-regresion.html"><a href="arboles-de-regresion.html"><i class="fa fa-check"></i><b>1</b> Árboles de regresión</a><ul>
<li class="chapter" data-level="" data-path="arboles-de-regresion.html"><a href="arboles-de-regresion.html#ejemplo"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="regarb.html"><a href="regarb.html"><i class="fa fa-check"></i><b>2</b> Regresión lineal versus árboles de regresión</a><ul>
<li class="chapter" data-level="2.1" data-path="regarb.html"><a href="regarb.html#regresion-lineal"><i class="fa fa-check"></i><b>2.1</b> Regresión lineal</a></li>
<li class="chapter" data-level="2.2" data-path="regarb.html"><a href="regarb.html#arboles-de-regresion-1"><i class="fa fa-check"></i><b>2.2</b> Arboles de regresión</a></li>
<li class="chapter" data-level="2.3" data-path="regarb.html"><a href="regarb.html#ejemplo-1"><i class="fa fa-check"></i><b>2.3</b> Ejemplo 1</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="discri.html"><a href="discri.html"><i class="fa fa-check"></i><b>3</b> Análisis Discriminante</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modelos Predictivos</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regarb" class="section level1">
<h1><span class="header-section-number">2</span> Regresión lineal versus árboles de regresión</h1>
<div id="regresion-lineal" class="section level2">
<h2><span class="header-section-number">2.1</span> Regresión lineal</h2>
<p>El modelo de regresión lineal simple es uno de los más populares en modelación. Este modelo se puede resumir a continuación.</p>
<p><span class="math display">\[\begin{align}
y_i &amp;\sim N(\mu_i, \sigma^2), \\ 
\mu_i &amp;= \beta_0 + \beta_1 x_i, \\
\sigma^2 &amp;= \text{constante}
\end{align}\]</span></p>
</div>
<div id="arboles-de-regresion-1" class="section level2">
<h2><span class="header-section-number">2.2</span> Arboles de regresión</h2>
<p>Un árbol de regresión es un árbol de decisión. Para conocer más sobre el tema se recomienda ver <a href="https://www.youtube.com/watch?v=7VeUPuFGJHk">este video</a>.</p>
<p>Las librerías en R para implementar árboles de regresión son:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rpart)
<span class="kw">library</span>(rpart.plot)</code></pre>
</div>
<div id="ejemplo-1" class="section level2">
<h2><span class="header-section-number">2.3</span> Ejemplo 1</h2>
<p>Como ilustración vamos a usar los datos del ejemplo 2.1 del libro de <a href="https://www.amazon.com/Introduccion-analisis-regresion-lineal-Spanish/dp/9702403278">Montgomery, Peck and Vining (2003)</a>. En el ejemplo 2.1 los autores ajustaron un modelo de regresión lineal simple para explicar la Resistencia de una soldadura en función de la Edad de la misma.</p>
<p>A continuación el código para cargar los datos y una muestra de las 6 primeras observaciones de la base de datos, en total tenemos 20 observaciones.</p>
<pre class="sourceCode r"><code class="sourceCode r">file &lt;-<span class="st"> &quot;https://raw.githubusercontent.com/fhernanb/datos/master/propelente&quot;</span>
datos &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="dt">file=</span>file, <span class="dt">header=</span><span class="ot">TRUE</span>)
<span class="kw">head</span>(datos) <span class="co"># shows the first 6 rows</span></code></pre>
<pre><code>##   Resistencia  Edad
## 1     2158.70 15.50
## 2     1678.15 23.75
## 3     2316.00  8.00
## 4     2061.30 17.00
## 5     2207.50  5.50
## 6     1708.30 19.00</code></pre>
<p>Para crear un diagrama de dispersión que nos muestre la relación entre las dos variables usamos las siguientes instrucciones.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">ggplot</span>(datos, <span class="kw">aes</span>(<span class="dt">x=</span>Edad, <span class="dt">y=</span>Resistencia)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_light</span>()</code></pre>
<p><img src="libro_mod_pred_files/figure-html/soldadura1-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>De la figura anterior se ve claramente que a medida que aumenta la edad de la soldadura, la resistencia que ella ofrece disminuye. Adicionalmente, se observa que la relación entre las variables es lineal con una dispersión que parece constante.</p>
<p>¿Quién estima mejor? ¿un modelo de regresión lineal simple o un árbol?</p>
<pre class="sourceCode r"><code class="sourceCode r">rls &lt;-<span class="st"> </span><span class="kw">lm</span>(Resistencia <span class="op">~</span><span class="st"> </span>Edad, <span class="dt">data=</span>datos)
arb &lt;-<span class="st"> </span><span class="kw">rpart</span>(Resistencia <span class="op">~</span><span class="st"> </span>Edad, <span class="dt">data=</span>datos)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">arb &lt;-<span class="st"> </span><span class="kw">rpart</span>(Resistencia <span class="op">~</span><span class="st"> </span>Edad, <span class="dt">data=</span>datos, <span class="dt">method=</span><span class="st">&quot;anova&quot;</span>)
<span class="kw">prp</span>(arb)</code></pre>
<p><img src="libro_mod_pred_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>¿Qué hay dentro de modelo de regresión lineal simple?</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(rls)</code></pre>
<pre><code>## 
## Call:
## lm(formula = Resistencia ~ Edad, data = datos)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -215.98  -50.68   28.74   66.61  106.76 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 2627.822     44.184   59.48  &lt; 2e-16 ***
## Edad         -37.154      2.889  -12.86 1.64e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 96.11 on 18 degrees of freedom
## Multiple R-squared:  0.9018, Adjusted R-squared:  0.8964 
## F-statistic: 165.4 on 1 and 18 DF,  p-value: 1.643e-10</code></pre>
<p>¿Qué hay dentro de modelo del arbol?</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(arb)</code></pre>
<pre><code>## Call:
## rpart(formula = Resistencia ~ Edad, data = datos, method = &quot;anova&quot;)
##   n= 20 
## 
##          CP nsplit rel error   xerror      xstd
## 1 0.7480619      0 1.0000000 1.066376 0.2254468
## 2 0.0100000      1 0.2519381 1.066376 0.2254468
## 
## Variable importance
## Edad 
##  100 
## 
## Node number 1: 20 observations,    complexity param=0.7480619
##   mean=2131.358, MSE=84686.88 
##   left son=2 (8 obs) right son=3 (12 obs)
##   Primary splits:
##       Edad &lt; 16.25 to the right, improve=0.7480619, (0 missing)
## 
## Node number 2: 8 observations
##   mean=1823.094, MSE=19439.95 
## 
## Node number 3: 12 observations
##   mean=2336.867, MSE=22599.79</code></pre>
<p>Dijuemos el árbol con <code>prp</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prp</span>(arb)</code></pre>
<p><img src="libro_mod_pred_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>Construyamos nuevamente el árbol pero explorando todas las opciones de la función <code>prp</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prp</span>(arb, <span class="dt">main =</span> <span class="st">&quot;Mi árbol bonito&quot;</span>,
    <span class="dt">nn =</span> <span class="ot">TRUE</span>,             <span class="co"># display the node numbers</span>
    <span class="dt">fallen.leaves =</span> <span class="ot">TRUE</span>,  <span class="co"># put the leaves on the bottom of the page</span>
    <span class="dt">shadow.col =</span> <span class="st">&quot;gray&quot;</span>,   <span class="co"># shadows under the leaves</span>
    <span class="dt">branch.lty =</span> <span class="dv">3</span>,        <span class="co"># draw branches using dotted lines</span>
    <span class="dt">branch =</span> <span class="fl">.5</span>,           <span class="co"># change angle of branch lines</span>
    <span class="dt">faclen =</span> <span class="dv">0</span>,            <span class="co"># faclen = 0 to print full factor names</span>
    <span class="dt">trace =</span> <span class="dv">1</span>,             <span class="co"># print the auto calculated cex, xlim, ylim</span>
    <span class="dt">split.cex =</span> <span class="fl">1.2</span>,       <span class="co"># make the split text larger than the node text</span>
    <span class="dt">split.prefix =</span> <span class="st">&quot;is &quot;</span>,  <span class="co"># put &quot;is &quot; before split text</span>
    <span class="dt">split.suffix =</span> <span class="st">&quot;?&quot;</span>,    <span class="co"># put &quot;?&quot; after split text</span>
    <span class="dt">split.box.col =</span> <span class="st">&quot;lightgray&quot;</span>,   <span class="co"># lightgray split boxes (default is white)</span>
    <span class="dt">split.border.col =</span> <span class="st">&quot;darkgray&quot;</span>, <span class="co"># darkgray border on split boxes</span>
    <span class="dt">split.round =</span> <span class="fl">.5</span>)              <span class="co"># round the split box corners a tad</span></code></pre>
<pre><code>## cex 1   xlim c(-0.65, 1.65)   ylim c(-0.75, 1.75)</code></pre>
<p><img src="libro_mod_pred_files/figure-html/unnamed-chunk-22-1.png" width="768" /></p>
<p>A continuación las predicciones con ambos modelos.</p>
<pre class="sourceCode r"><code class="sourceCode r">pred_rls &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object=</span>rls, <span class="dt">newdata=</span>datos)
pred_arb &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object=</span>arb, <span class="dt">newdata=</span>datos)</code></pre>
<p>Dibujemos <span class="math inline">\(y_i\)</span> versus <span class="math inline">\(\hat{y}_i\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))
<span class="kw">plot</span>(<span class="dt">x=</span>pred_rls, <span class="dt">y=</span>datos<span class="op">$</span>Resistencia, <span class="dt">main=</span><span class="st">&quot;RLS&quot;</span>)
<span class="kw">abline</span>(<span class="dt">a=</span><span class="dv">0</span>, <span class="dt">b=</span><span class="dv">1</span>, <span class="dt">lty=</span><span class="st">&quot;dashed&quot;</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)
<span class="kw">plot</span>(<span class="dt">x=</span>pred_arb, <span class="dt">y=</span>datos<span class="op">$</span>Resistencia, <span class="dt">main=</span><span class="st">&quot;Arbol&quot;</span>)
<span class="kw">abline</span>(<span class="dt">a=</span><span class="dv">0</span>, <span class="dt">b=</span><span class="dv">1</span>, <span class="dt">lty=</span><span class="st">&quot;dashed&quot;</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</code></pre>
<p><img src="libro_mod_pred_files/figure-html/unnamed-chunk-24-1.png" width="768" /></p>
<p>Vamos a calcular <span class="math inline">\(Cor(y_i, \hat{y}_i)\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(datos<span class="op">$</span>Resistencia, pred_rls)</code></pre>
<pre><code>## [1] 0.9496533</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(datos<span class="op">$</span>Resistencia, pred_arb)</code></pre>
<pre><code>## [1] 0.8649057</code></pre>
<p>Calculemos ahora el Error Cuadrático Medio <span class="math inline">\(ECM=\frac{1}{n}\sum(y_i-\hat{y}_i)^2\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>((datos<span class="op">$</span>Resistencia <span class="op">-</span><span class="st"> </span>pred_rls)<span class="op">^</span><span class="dv">2</span>)</code></pre>
<pre><code>## [1] 8312.743</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>((datos<span class="op">$</span>Resistencia <span class="op">-</span><span class="st"> </span>pred_arb)<span class="op">^</span><span class="dv">2</span>)</code></pre>
<pre><code>## [1] 21335.85</code></pre>
<p>¿Cuál método prefiere usted?</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="arboles-de-regresion.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="discri.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/fhernanb/libro_mod_pred/edit/master/01-reg-arb.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["libro_mod_pred.pdf", "libro_mod_pred.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
